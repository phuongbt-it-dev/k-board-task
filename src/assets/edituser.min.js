"use strict";checkLogin("adduser"),md5(localStorage.getItem("CurrentUser")+localStorage.getItem("CurrentEmail"))===Cookies.get("Token")&&(getParameterByName("id")===localStorage.getItem("CurrentUserID")||"1"===localStorage.getItem("CurrentUserID"))?$(".waitforpermission-sec").removeClass("waitforpermission-sec"):window.location.href="/nopermission";var oldPaswToEdit=null;function __edituser_getLists(){var s=getParameterByName("id");$.ajax({url:Global.API_URL+"/user.json?id="+s,type:"GET",async:!0,dataType:"json",cache:!0,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+Cookies.get("Token"))},error:function(e,t,r){},complete:function(e){var t=JSON.parse(e.responseText);for(var r in t)t.hasOwnProperty(r)&&r===s&&(t=t[r]);for(var r in oldPaswToEdit=t.password,$("#username").val(t.username).prop("disabled",!0),$("#email").val(t.email).prop("disabled",!0),$("#fullname").val(t.fullname),t.permision)if(t.permision.hasOwnProperty(r)){var a=t.permision[r];a&&0!=a&&"false"!==a?$("#"+r).prop("checked",!0):$("#"+r).prop("checked",!1)}}})}function __user_editNew(){var r=getParameterByName("id");$("form.validator").validator().on("submit",function(e){if(e.isDefaultPrevented())alert("Vui lòng kiểm tra lại thông tin");else{var t=JSON.stringify({id:r,username:$("#username").val(),password:$("#password").val()&&0<$("#password").val().length?md5($("#password").val()):oldPaswToEdit,email:$("#email").val(),fullname:$("#fullname").val(),permision:{dashboard:$("#dashboard").prop("checked"),createtask:$("#createtask").prop("checked"),deltassk:$("#deltassk").prop("checked"),modifytask:$("#modifytask").prop("checked"),adduser:$("#adduser").prop("checked"),userlist:$("#userlist").prop("checked"),settings:$("#settings").prop("checked"),archivetask:$("#archivetask").prop("checked"),viewtask:$("#viewtask").prop("checked"),movetask:$("#movetask").prop("checked"),viewuser:$("#viewuser").prop("checked")},settings:{editor:Settings.Editor,pagesize:Settings.pageSize,activenumberstep1drag:Settings.ActiveNumberStep1Drag,activenumberstep2drop:Settings.ActiveNumberStep2Drop,oneway:Settings.OneWay}});$.ajax({url:"/edit",type:"POST",async:!0,dataType:"json",cache:!0,data:t,contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+Cookies.get("Token"))},error:function(e,t,r){},complete:function(e){"error"===e.responseText?alert("Có lỗi xảy ra"):toastrMsg("Cập nhật hoàn tất","Cập nhật",2e3)}})}return!1})}$(document).ready(function(){__edituser_getLists(),__user_editNew()});